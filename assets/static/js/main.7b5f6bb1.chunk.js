(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{1:function(e,t){e.exports={Host:"",Version:"/v1",Message:"/message",User:"/user",TokenInfo:"/token/info",Login:"/login"}},32:function(e,t,a){},37:function(e,t,a){e.exports=a(73)},42:function(e,t,a){},60:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},61:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(33),s=a.n(c);a(42),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var r=a(13),i=a(14),l=a(3),u=a(4),m=a(6),d=a(5),p=a(7),g=a(11),f=a.n(g),h=(a(60),a(61),a(36)),v=a(17),b=a.n(v),E=(a(63),function(e){function t(e){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).call(this,e))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"message"},o.a.createElement("div",{className:"message-time"},b.a.unix(this.props.msgInfo.sendTime).format("YYYY-MM-DD HH:mm")),o.a.createElement("div",{className:this.props.msgInfo.private?"message-sender private":"message-sender"},this.props.msgInfo.senderName," :"),o.a.createElement("div",{className:"message-content"},o.a.createElement("span",{className:"message-content-content"},this.props.msgInfo.content," ")))}}]),t}(o.a.Component)),N=a(1),k=a.n(N),O=(a(64),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).componentWillMount=function(){var e=setInterval((function(){f.a.get("".concat(k.a.Host).concat(k.a.Version).concat(k.a.Message),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("iris-token"))},params:{beginTime:b()().subtract(2,"days").format("X"),endTime:0,beginId:a.state.lastMsgId}}).then((function(e){var t=a.state.lastMsgId;console.log(" => ",t);var n=e.data.data,o=n.length,c=Object(h.a)(a.state.msgList);n.forEach((function(e){c.push(e)})),a.setState({msgList:c,lastMsgId:0===o?t:n[o-1].id})})).catch((function(e){console.log("\u83b7\u53d6\u6d88\u606f\u5931\u8d25 => ",e)}))}),700);a.setState({timerId:e})},a.componentWillUnmount=function(){clearTimeout(a.state.timerId)},a.state={timerId:0,lastMsgId:0,msgList:[]},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){this.refs["msg-container"].scrollIntoView({behavior:"smooth",block:"end"})}},{key:"render",value:function(){return o.a.createElement("div",{className:"msg-container",ref:"msg-container"},this.state.msgList.map((function(e,t){return o.a.createElement(E,{key:t,msgInfo:e})})))}}]),t}(o.a.Component)),j=a(19),I=a.n(j),w=(a(66),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).sendMsg=function(){var e,t,n,o,c;return I.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=a.refs.receiverName.value,t=a.refs.content.value,s.next=4,I.a.awrap(f.a.get("".concat(k.a.Host).concat(k.a.Version).concat(k.a.User),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("iris-token"))}}));case 4:if(200!==(c=s.sent).status){s.next=10;break}n=c.data.data,console.log("\u83b7\u53d6\u7528\u6237\u5217\u8868\u6210\u529f => ",n),s.next=12;break;case 10:return alert("\u53d1\u9001\u5931\u8d25\uff1a\u83b7\u53d6\u7528\u6237\u5217\u8868\u5931\u8d25\u3002"),s.abrupt("return");case 12:if(""===e?o=0:n.forEach((function(t){t.username===e&&(o=t.id,console.log("\u6210\u529f\u83b7\u53d6\u63a5\u53d7\u8005\u4fe1\u606f => ",t))})),void 0!==o){s.next=16;break}return alert("\u53d1\u9001\u5931\u8d25\uff1a\u65e0\u6cd5\u627e\u5230\u7528\u6237\u540d\u4e3a".concat(e,"\u7684\u63a5\u53d7\u8005")),s.abrupt("return");case 16:if(""!==t){s.next=19;break}return alert("\u53d1\u9001\u5931\u8d25\uff1a\u4f60\u4e0d\u80fd\u53d1\u9001\u7a7a\u6d88\u606f"),s.abrupt("return");case 19:console.log("\u6b63\u5728\u7ed9id\u4e3a=>".concat(o,"\u7684\u7528\u6237\u53d1\u9001\u6d88\u606f=>").concat(t)),f.a.post("".concat(k.a.Host).concat(k.a.Version).concat(k.a.Message),{receiverId:o,content:t},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("iris-token"))}}).then((function(e){console.log("\u53d1\u9001\u6210\u529f => ",e),a.refs.content.value=""})).catch((function(e){console.log("\u53d1\u9001\u5931\u8d25 => ",e)}));case 21:case"end":return s.stop()}}))},a.logout=function(){console.log("\u6b63\u5728\u6ce8\u9500\u7528\u6237"),console.log("\u6b63\u5728\u6e05\u9664localStroage"),localStorage.removeItem("iris-token"),console.log("\u6e05\u9664localStroage\u6210\u529f\uff0c\u5b8c\u6210\u6ce8\u9500"),window.location.reload()},console.log(e),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"sendbox"},o.a.createElement("div",{className:"sendbox-sendto"},o.a.createElement("button",{className:"sendbox-sendto-sender",onClick:this.logout},this.props.userInfo.username),o.a.createElement("div",{className:"sendbox-sendto-charto"},"to"),o.a.createElement("input",{className:"sendbox-sendto-receiver",placeholder:"All",ref:"receiverName"})),o.a.createElement("div",{className:"sendbox-msg"},o.a.createElement("input",{className:"sendbox-msg-input",placeholder:"\u8bf7\u8f93\u5165\u6d88\u606f\u5185\u5bb9",ref:"content"}),o.a.createElement("button",{className:"sendbox-msg-button",onClick:this.sendMsg},"\u53d1\u9001")))}}]),t}(o.a.Component)),x=(a(67),function(e){function t(e){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).call(this,e))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"sign"},o.a.createElement(r.b,{to:"/signin"},o.a.createElement("button",{className:"sign-in"},"\u767b\u5f55")),o.a.createElement(r.b,{to:"/signup"},o.a.createElement("button",{className:"sign-up"},"\u6ce8\u518c")))}}]),t}(o.a.Component)),y=(a(32),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).login=function(){var e=a.refs.username.value,t=a.refs.passwd.value;console.log(e,t),f.a.post("".concat(k.a.Host).concat(k.a.Version).concat(k.a.Login),{username:e,passwd:t}).then((function(e){"200"===e.data.code?(alert("\u767b\u5f55\u6210\u529f"),console.log("\u767b\u5f55\u6210\u529f => ",e),localStorage.setItem("iris-token",e.data.data.token),console.log("\u5df2\u7ecf\u5c06\u767b\u5f55\u83b7\u5f97\u7684token\u5b58\u5165localStorage"),a.props.history.push("")):alert(e.data.code)})).catch((function(e){alert("\u767b\u5f55\u5931\u8d25".concat(JSON.stringify(e))),console.log("\u767b\u5f55\u5931\u8d25 => ",e)}))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"page-sign-in"},o.a.createElement("div",{className:"page-header"},"\u767b\u5f55"),o.a.createElement("div",{className:"page-content"},o.a.createElement("div",{className:"input-title"},"\u7528\u6237\u540d"),o.a.createElement("input",{className:"input-area",ref:"username"}),o.a.createElement("div",{className:"input-title"},"\u5bc6\u7801"),o.a.createElement("input",{className:"input-area",ref:"passwd",type:"password"}),o.a.createElement("div",{className:"input-button"},o.a.createElement("button",{className:"input-button-ok",onClick:this.login},"\u767b\u5f55"),o.a.createElement(r.b,{to:"/"},o.a.createElement("button",{className:"input-button-return"},"\u8fd4\u56de")))))}}]),t}(o.a.Component)),M=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).register=function(){var e=a.refs.username.value,t=a.refs.passwd.value,n=a.refs.gender.value,o=a.refs.age.value,c=a.refs.interest.value;f.a.post("".concat(k.a.Host).concat(k.a.Version).concat(k.a.User),{username:e,passwd:t,gender:n,age:o,interest:c}).then((function(e){200==e.data.code?(alert("\u6ce8\u518c\u6210\u529f"),console.log("\u6ce8\u518c\u6210\u529f => ",e)):alert("\u6ce8\u518c\u5931\u8d25\uff1a"+e.data.msg)})).catch((function(e){console.log("\u6ce8\u518c\u5931\u8d25 => ",e)}))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"page-sign-up"},o.a.createElement("div",{className:"page-header"},"\u6ce8\u518c"),o.a.createElement("div",{className:"page-content"},o.a.createElement("div",{className:"input-title"},"\u7528\u6237\u540d"),o.a.createElement("input",{className:"input-area",ref:"username"}),o.a.createElement("div",{className:"input-title"},"\u5bc6\u7801"),o.a.createElement("input",{className:"input-area",ref:"passwd"}),o.a.createElement("div",{className:"input-title"},"\u6027\u522b"),o.a.createElement("select",{className:"input-area",ref:"gender"},o.a.createElement("option",{value:"1"},"\u5973"),o.a.createElement("option",{value:"2"},"\u7537")),o.a.createElement("div",{className:"input-title"},"\u5e74\u9f84"),o.a.createElement("input",{className:"input-area",ref:"age"}),o.a.createElement("div",{className:"input-title"},"\u5174\u8da3\u7231\u597d"),o.a.createElement("input",{className:"input-area",ref:"interest"}),o.a.createElement("div",{className:"input-button"},o.a.createElement("button",{className:"input-button-ok",onClick:this.register},"\u6ce8\u518c"),o.a.createElement(r.b,{to:"/"},o.a.createElement("button",{className:"input-button-return"},"\u8fd4\u56de")))))}}]),t}(o.a.Component),S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).componentWillMount=function(){console.log("componentWillMount"),f.a.get("".concat(k.a.Host).concat(k.a.Version).concat(k.a.TokenInfo),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("iris-token"))}}).then((function(e){console.log("\u9a8c\u8bc1\u767b\u5f55token\u6210\u529f =>",e),a.setState({logged:!0,userInfo:e.data.data})})).catch((function(e){console.log("\u9a8c\u8bc1\u767b\u5f55token\u5931\u8d25 => ",e)}))},a.state={userInfo:null,logged:!1,msgList:[]},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"app-header"},"\u5728\u7ebf\u804a\u5929\u5ba4"),o.a.createElement("div",{className:"app-content"},o.a.createElement(O,null)),o.a.createElement("div",{className:"app-bottom"},this.state.logged?o.a.createElement(w,{userInfo:this.state.userInfo}):o.a.createElement(x,null)))}}]),t}(o.a.Component);s.a.render(o.a.createElement(r.a,null,o.a.createElement(i.c,null,o.a.createElement(i.a,{path:"/signin",component:y}),o.a.createElement(i.a,{path:"/signup",component:M}),o.a.createElement(i.a,{path:"/",component:S}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[37,1,2]]]);
//# sourceMappingURL=main.7b5f6bb1.chunk.js.map